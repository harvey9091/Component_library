<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PremiumNavBar Demo</title>
  <style>
    /*! Minimal CSS reset and Tailwind utilities */
    *,::before,::after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}*{margin:0;padding:0}html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}body{min-height:100vh}.flex{display:flex}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.gap-4{gap:1rem}.p-4{padding:1rem}.text-center{text-align:center}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99/var(--tw-text-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.min-h-screen{min-height:100vh}.w-full{width:100%}.rounded-lg{border-radius:.5rem}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0/.1),0 2px 4px -2px rgb(0 0 0/.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.p-6{padding:1.5rem}.mb-2{margin-bottom:.5rem}
    
    /* Error overlay styles */
    .error-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #ff0000;
      color: white;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      font-family: monospace;
      overflow: auto;
    }
    
    .error-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 1rem;
    }
    
    .error-message {
      font-size: 1rem;
      max-width: 80%;
      text-align: center;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div id="root">
    <div class="p-4 text-center">
      <h2 class="text-xl font-bold mb-2">PremiumNavBar Demo</h2>
      <p class="text-gray-600">Loading component...</p>
    </div>
  </div>
  
  <script>
    // Simple error handling
    window.onerror = function(message, source, lineno, colno, error) {
      console.error('Global error:', message, 'at', source, ':', lineno, ':', colno);
      showError('Global Error: ' + message);
      return true;
    };
    
    // Promise rejection handler
    window.addEventListener('unhandledrejection', function(event) {
      console.error('Unhandled promise rejection:', event.reason);
      showError('Promise Rejection: ' + event.reason);
      event.preventDefault();
    });
    
    // Show error overlay
    function showError(message) {
      // Remove existing error overlay if present
      const existingOverlay = document.querySelector('.error-overlay');
      if (existingOverlay) {
        existingOverlay.remove();
      }
      
      // Create error overlay
      const overlay = document.createElement('div');
      overlay.className = 'error-overlay';
      overlay.innerHTML = `
        <div class="error-title">DEMO RENDERING ERROR</div>
        <div class="error-message">${message}</div>
        <div class="error-message" style="margin-top: 1rem; font-size: 0.8rem;">Check browser console for detailed stack trace</div>
      `;
      document.body.appendChild(overlay);
    }
    
    // Try to connect to live-reload websocket (optional)
    try {
      const ws = new WebSocket('ws://localhost:8081');
      ws.onopen = function() {
        console.log('Demo: Live-reload WebSocket connected');
      };
      ws.onerror = function() {
        console.log('Demo: Live-reload WebSocket connection failed (continuing without live-reload)');
      };
    } catch (e) {
      console.log('Demo: Live-reload WebSocket unavailable (continuing without live-reload)');
    }
  </script>
  
  <!-- Load React and ReactDOM from CDN as fallback -->
  <script>
    // Function to load a script and return a promise
    function loadScript(src) {
      return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = src;
        script.onload = () => resolve();
        script.onerror = () => reject(new Error(`Failed to load script: ${src}`));
        document.head.appendChild(script);
      });
    }
    
    // Load React and ReactDOM
    Promise.all([
      loadScript('https://unpkg.com/react@19.2.1/umd/react.development.js'),
      loadScript('https://unpkg.com/react-dom@19.2.1/umd/react-dom.development.js')
    ]).then(() => {
      console.log('Demo: React and ReactDOM loaded successfully');
      window.reactLoaded = true;
      window.reactDOMLoaded = true;
      // Trigger the component rendering
      if (window.componentRenderCallback) {
        window.componentRenderCallback();
      }
    }).catch(error => {
      console.error('Demo: Failed to load React or ReactDOM:', error);
      showError('Failed to load React or ReactDOM: ' + error.message);
    });
  </script>
  
  <!-- Load the bundled component -->
  <script>
    console.log('Demo: loading bundle: ./PremiumNavBar.bundle.js');
  </script>
  <script src="./PremiumNavBar.bundle.js?v=1764860883318"></script>
  <script>
    console.log('Demo: bundle loaded');
  </script>
  
  <script>
    // Store the render callback to be called when React is ready
    window.componentRenderCallback = function() {
      try {
        console.log('Demo: Starting component rendering process...');
        
        // Render the component
        const rootElement = document.getElementById('root');
        if (!rootElement) {
          console.error('Demo: Root element not found');
          showError('Root element not found. Check browser console for details.');
          return;
        }
        
        // Clear the root element
        rootElement.innerHTML = '';
        
        // Try to render with React
        try {
          // Check if React and ReactDOM are available
          console.log('Demo: React present:', typeof React !== 'undefined', React?.version ? 'version: ' + React.version : '');
          console.log('Demo: ReactDOM present:', typeof ReactDOM !== 'undefined', ReactDOM?.version ? 'version: ' + ReactDOM.version : '');
          
          // Check if we have the component
          console.log('Demo: Bundle exports:', Object.keys(typeof DemoComponent !== 'undefined' ? DemoComponent : {}));
          
          if (typeof DemoComponent === 'undefined') {
            console.error('Demo: DemoComponent is not defined');
            showError('DemoComponent is not defined. Check browser console for details.');
            return;
          }
          
          // Get the component
          const Component = DemoComponent.default || DemoComponent;
          
          if (!Component) {
            console.error('Demo: Component not found in DemoComponent');
            showError('Component not found in DemoComponent. Check browser console for details.');
            return;
          }
          
          console.log('Demo: Found DemoComponent:', typeof Component);
          
          if (typeof ReactDOM !== 'undefined' && typeof React !== 'undefined') {
            if (ReactDOM.createRoot) {
              console.log('Demo: Using createRoot');
              const root = ReactDOM.createRoot(rootElement);
              const element = React.createElement(Component);
              root.render(element);
              console.log('Demo: Mount succeeded');
            } else if (ReactDOM.render) {
              console.log('Demo: Using legacy render');
              const element = React.createElement(Component);
              ReactDOM.render(element, rootElement);
              console.log('Demo: Mount succeeded');
            } else {
              throw new Error('No rendering method found');
            }
          } else {
            throw new Error('React or ReactDOM not available');
          }
        } catch (renderError) {
          console.error('Demo: Mount failed:', renderError);
          console.error('Demo: Render error stack:', renderError.stack);
          showError('Mount failed: ' + renderError.message);
          throw renderError;
        }
      } catch (error) {
        console.error('Demo: Error in main rendering process:', error);
        console.error('Demo: Error stack:', error.stack);
        showError('Rendering process failed: ' + error.message);
      }
    };
    
    // If React is already loaded, render immediately
    // Otherwise, wait for the loadScript promises to resolve
    if (window.reactLoaded && window.reactDOMLoaded) {
      window.componentRenderCallback();
    }
  </script>
</body>
</html>